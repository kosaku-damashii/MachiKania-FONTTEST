USEGRAPHIC 9
USECLASS CKNJ16
USEVAR MAXH,MAXW,CHRH,CHRW,CODE,CSR_X,CSR_Y
MAXW=SYSTEM(22)
MAXH=SYSTEM(23)
CHRW=16
CHRH=16
CSR_X=0
CSR_Y=0
CODE=$A4A1

INTERRUPT INKEY,ISRKEY

X=0
Y=MAXH-1-CHRH
POINT X,Y
C$=CHR$((CODE>>8) AND $FF)+CHR$(CODE AND $FF)+CHR$($00)
K=NEW(CKNJ16,"EUC-JP")
K.GPRT(C,7,0)
WHILE 1
  S=READKEY()
  IF S THEN
    A=(S >> 8) AND $FF
    CURSOR CSR_X,CSR_Y
    PRINT "  "
    IF A=$26 THEN
      CSR_Y=CSR_Y-2
    ELSEIF A=$28 THEN
      CSR_Y=CSR_Y+2
    ELSEIF A=$25 THEN
      CSR_X=CSR_X-2
    ELSEIF A=$27 THEN
      CSR_X=CSR_X+2
    ENDIF

    IF CSR_X < 0 THEN
      CSR_X=0
    ELSEIF CSR_X > SYSTEM(20) THEN
      CSR_X=SYSTEM(20)-1
    ELSEIF CSR_Y < 0 THEN
      CSR_Y=0
    ELSEIF CSR_Y > SYSTEM(21) THEN
      CSR_Y=SYSTEM(21)-1
    ENDIF


    CURSOR CSR_X,CSR_Y
    PRINT CHR$($5F)+CHR$($5F)
  ENDIF
WEND


LABEL ISRKEY
RETURN
